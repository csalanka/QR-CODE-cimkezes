<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Címkenyomtatás</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
    <style>
        .cimke {
            width: 60mm;
            height: 30mm;
            padding: 3mm;
            border: 1px solid black;
            display: flex;
            justify-content: space-between;
            align-items: center; /* Középre igazítás függőlegesen */
            font-family: Arial, sans-serif;
            font-size: 10px;
            position: relative;
        }

        .qr-container {
            width: 25mm; /* QR kód mérete */
            height: 25mm;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-left: -3mm; /* Picit balra tolás */
        }

        .szoveg-container {
            display: flex;
            flex-direction: column; /* Vertikálisan egymás alá rendezzük */
            align-items: center; /* Középre igazítjuk */
            justify-content: center;
            max-width: 60%;
            line-height: 1.5;
            padding-left: 5mm;
        }

        .szam {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
            text-align: center; /* Középre igazítás a számnál */
        }

        .szoveg {
            text-align: center; /* Középre igazított szöveg */
            line-height: 1.5;
        }

        .warning {
            color: red;
            font-weight: bold;
        }

        #text-input {
            width: 100%;
            font-size: 14px;
            padding: 5px;
        }

        .char-counter {
            font-size: 12px;
            text-align: right;
            margin-top: 5px;
        }
    </style>
</head>
<body>

    <h1>QR Kódos Címke Generálás</h1>
    <label for="text-input">Szöveg (szám + leírás):</label>
    <input type="text" id="text-input" placeholder="Pl.: 7004567 Leírás" oninput="updateCharCount()">
    <div class="char-counter" id="char-count">Karakterek hátralevő száma: 60</div>
    <button onclick="generateQRCode()">QR Kód Generálás</button>
    <br><br>

    <div id="warning-message" class="warning"></div> <!-- Figyelmeztető üzenet -->

    <!-- Címke megjelenítése -->
    <div class="cimke">
        <div class="qr-container">
            <canvas id="qrcode"></canvas>
        </div>
        <div class="szoveg-container">
            <div id="szam" class="szam"></div>
            <div id="szoveg" class="szoveg"></div>
        </div>
    </div>

    <script>
        function updateCharCount() {
            var inputText = document.getElementById("text-input").value;
            var remainingChars = 60 - inputText.length;
            document.getElementById("char-count").textContent = "Karakterek hátralevő száma: " + remainingChars;
        }

        function generateQRCode() {
            var text = document.getElementById("text-input").value;

            if (!text) {
                alert("Kérlek, írj be valamilyen szöveget!");
                return;
            }

            // Ellenőrizzük, hogy a szöveg nem hosszabb, mint 60 karakter
            if (text.length > 60) {
                document.getElementById("warning-message").textContent = "A beírt szöveg túl hosszú. Kérlek, csökkentsd 60 karakterre!";
                return;
            } else {
                document.getElementById("warning-message").textContent = ""; // Üzenet eltüntetése, ha minden rendben
            }

            // Kiegészítjük a szöveget szóközökkel, hogy 60 karakteres legyen
            var paddedText = text;
            if (paddedText.length < 60) {
                var spacesToAdd = 60 - paddedText.length;
                paddedText += ' '.repeat(spacesToAdd); // Kiegészítjük szóközökkel
            }

            // Első szó (szám) és a többi különválasztása
            var parts = paddedText.split(" ");
            var numberPart = parts.shift(); // Első szó (szám)
            var textPart = parts.join(" "); // A maradék szöveg

            // Beállítás a címkén
            document.getElementById("szam").textContent = numberPart;
            document.getElementById("szoveg").textContent = textPart;

            // QR-kód generálása
            var qrCanvas = document.getElementById("qrcode");

            QRCode.toCanvas(qrCanvas, paddedText, function(error) {
                if (error) {
                    console.error("QR Kód generálási hiba:", error);
                    alert("Hiba történt a QR-kód generálása közben.");
                } else {
                    console.log("QR kód generálva!");
                    qrCanvas.style.display = "block"; // QR kód megjelenítése
                }
            });
        }
    </script>

</body>
</html>
