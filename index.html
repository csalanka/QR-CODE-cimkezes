import qrcode

# 1. QR Kód Generálás
def generate_qr_code(text):
    # QR kód generálása
    qr = qrcode.QRCode(
        version=1,
        error_correction=qrcode.constants.ERROR_CORRECT_L,
        box_size=10,
        border=4,
    )
    qr.add_data(text)
    qr.make(fit=True)

    # QR kód képfájl mentése
    img = qr.make_image(fill='black', back_color='white')
    img.save("qr_code.png")
    print("QR kód generálva és mentve: qr_code.png")

# 2. Címke Olvasás (Foglalás)
import cv2

def read_qr_code(image_path):
    # QR kód beolvasása
    img = cv2.imread(image_path)
    detector = cv2.QRCodeDetector()
    value, pts, qr_code = detector(img)
    
    if value:
        print("Beolvasott QR kód adat: ", value)
        return value
    else:
        print("QR kód nem található!")
        return None

# 3. Foglalási Lista
class Reservation:
    def __init__(self, code, description):
        self.code = code
        self.description = description
        self.status = "Pending"

    def __str__(self):
        return f"Foglalás: {self.code}, Leírás: {self.description}, Státusz: {self.status}"

reservations = []

def add_reservation(code, description):
    reservation = Reservation(code, description)
    reservations.append(reservation)
    print("Foglalás hozzáadva: ", reservation)

# 4. Verzió Információ
class VersionInfo:
    def __init__(self, version_number, change_log):
        self.version_number = version_number
        self.change_log = change_log

    def __str__(self):
        return f"Verzió: {self.version_number}\nVáltozások:\n{self.change_log}"

versions = [
    VersionInfo("1.0.0", "Első verzió"),
    VersionInfo("1.1.0", "Hibajavítások és új funkciók"),
]

def display_versions():
    for version in versions:
        print(version)

# Program menü
def menu():
    while True:
        print("\n1. QR Kód Generálás")
        print("2. Címke Olvasás (Foglalás)")
        print("3. Foglalási Lista")
        print("4. Verzió Információ")
        print("5. Kilépés")

        choice = input("Válassz egy lehetőséget: ")

        if choice == '1':
            text = input("Add meg az anyagszámot és leírást: ")
            generate_qr_code(text)
        elif choice == '2':
            image_path = input("Add meg a QR kód képfájlt: ")
            read_qr_code(image_path)
        elif choice == '3':
            if reservations:
                for res in reservations:
                    print(res)
            else:
                print("Nincs rögzített foglalás.")
        elif choice == '4':
            display_versions()
        elif choice == '5':
            print("Kilépés...")
            break
        else:
            print("Érvénytelen választás!")

# Program indítása
if __name__ == "__main__":
    menu()
